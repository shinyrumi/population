<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI 도구를 활용한 지속가능발전 수업 포트폴리오</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter font -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap">
    <!-- Chart.js for drawing charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(to bottom, #dbeafe, #e0f2fe);
        }
        .chart-legend-item {
            display: flex;
            align-items: center;
            margin-right: 1.5rem;
        }
        .chart-legend-color {
            width: 1.5rem;
            height: 0.5rem;
            margin-right: 0.5rem;
        }
        /* Custom styles for collapsible sections */
        .collapsible {
            cursor: pointer;
            padding: 18px;
            width: 100%;
            border: none;
            text-align: left;
            outline: none;
            font-size: 1.25rem;
            font-weight: 600;
            transition: 0.4s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .collapsible:after {
            content: '\25B6';
            font-size: 1.5rem;
            color: #6b7280;
            margin-left: 5px;
            transition: transform 0.3s ease;
        }
        .active:after {
            transform: rotate(90deg);
        }
        .content {
            padding: 0 18px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            background-color: #f1f5f9;
        }
    </style>
</head>
<body class="p-4 sm:p-8">
    <div class="bg-white rounded-3xl shadow-2xl w-full max-w-7xl mx-auto p-8 sm:p-12 space-y-12">

        <!-- Header -->
        <header class="text-center space-y-4">
            <h1 class="text-4xl sm:text-5xl font-bold text-gray-800">✨ AI 도구를 활용한 지속가능발전 수업 포트폴리오 ✨</h1>
            <p class="mt-2 text-lg sm:text-xl text-gray-500 max-w-3xl mx-auto">
                경남지역 인구소멸 문제를 해결하기 위한 프로젝트의 모든 여정을 담았습니다.
            </p>
        </header>

        <!-- Project Overview -->
        <section>
            <h2 class="text-3xl font-bold text-gray-800 mb-6">1. 프로젝트 개요 📚</h2>
            <div class="overflow-x-auto rounded-xl shadow-md">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-blue-200">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-blue-800 uppercase tracking-wider">항목</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-blue-800 uppercase tracking-wider">내용</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                        <tr>
                            <td class="px-6 py-4 whitespace-nowrap font-semibold">프로그램명</td>
                            <td class="px-6 py-4">AI와 함께하는 우리 마을 미래 설계 프로젝트</td>
                        </tr>
                        <tr>
                            <td class="px-6 py-4 whitespace-nowrap font-semibold">교과</td>
                            <td class="px-6 py-4">융합수업</td>
                        </tr>
                        <tr>
                            <td class="px-6 py-4 whitespace-nowrap font-semibold">학습목표</td>
                            <td class="px-6 py-4">
                                <ul class="list-disc list-inside space-y-1">
                                    <li>AI 도구를 활용하여 경남지역 인구 데이터를 분석하고, 인구소멸의 원인과 현황을 파악할 수 있다.</li>
                                    <li>인구소멸 문제를 해결하기 위한 창의적인 아이디어를 제안하고, 디지털 캠페인으로 시각화할 수 있다.</li>
                                    <li>탐구 및 캠페인 제작 과정을 기록하고, 동료와 피드백을 주고받으며 협력적 문제 해결 능력을 기를 수 있다.</li>
                                </ul>
                            </td>
                        </tr>
                        <tr>
                            <td class="px-6 py-4 whitespace-nowrap font-semibold">주요 도구</td>
                            <td class="px-6 py-4">NotebookLM, GEMINI, Vrew, Canva AI, KOSIS 자료, 디지털 스탬프/뱃지 시스템</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Project Process -->
        <section>
            <h2 class="text-3xl font-bold text-gray-800 mb-6">2. 프로젝트 수행 과정 🚀</h2>
            <div class="space-y-8">
                <!-- 도입 -->
                <div class="bg-indigo-100 p-6 rounded-2xl shadow-md border-l-4 border-indigo-500">
                    <h3 class="text-2xl font-bold text-indigo-800 mb-2">도입: 문제 인식 및 자료 탐색</h3>
                    <p class="text-gray-700">NotebookLM과 Vrew를 활용한 영상 시청 및 토론으로 인구소멸 문제를 인식하고, 초급 미션을 통해 우리 동네 인구 현황을 파악했습니다.</p>
                </div>
                <!-- 전개 -->
                <div class="bg-purple-100 p-6 rounded-2xl shadow-md border-l-4 border-purple-500">
                    <h3 class="text-2xl font-bold text-purple-800 mb-2">전개: 시뮬레이션 및 심층 분석</h3>
                    <p class="text-gray-700">Canva AI와 KOSIS 데이터를 활용하여 인구 변화 시뮬레이션을 제작하고, 중급 미션을 통해 인구 증감 지역의 특징과 청년 인구의 관계를 분석했습니다.</p>
                </div>
                <!-- 활동 -->
                <div class="bg-green-100 p-6 rounded-2xl shadow-md border-l-4 border-green-500">
                    <h3 class="text-2xl font-bold text-green-800 mb-2">활동: 아이디어 구체화 및 캠페인 제작</h3>
                    <p class="text-gray-700">포토보이스 활동으로 지역 문제를 기록하고, 고급 미션을 통해 청년 유치 정책 및 2050년 마을 계획 등 창의적인 해결책을 제안하며 캠페인을 제작했습니다.</p>
                </div>
                <!-- 정리 -->
                <div class="bg-yellow-100 p-6 rounded-2xl shadow-md border-l-4 border-yellow-500">
                    <h3 class="text-2xl font-bold text-yellow-800 mb-2">정리: 발표, 평가 및 성찰</h3>
                    <p class="text-gray-700">제작한 캠페인을 발표하고, 동료 평가와 자기 성찰 일기 작성을 통해 프로젝트의 배움을 정리하고 마무리했습니다.</p>
                </div>
            </div>
        </section>

        <!-- Creative Ideas Section -->
        <section>
            <h2 class="text-3xl font-bold text-gray-800 mb-6">3. 문제 해결 아이디어 예시: 유동 인구와 창의적 접근 💡</h2>
            <div class="space-y-6">
                <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
                    <h3 class="text-xl font-bold text-gray-800 mb-2">빈집 활용 '워케이션 허브'</h3>
                    <p class="text-gray-600">AI가 빈집 데이터를 분석해 워케이션 허브 후보지를 선정하고, 청년들이 일과 휴가를 동시에 즐길 수 있는 프로그램을 기획하여 유동 인구를 장기 체류 인구로 유도하는 방안입니다.</p>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
                    <h3 class="text-xl font-bold text-gray-800 mb-2">데이터 기반 축제 및 이벤트 기획</h3>
                    <p class="text-gray-600">AI가 SNS 빅데이터를 분석하여 청년층의 관심사를 파악하고, 이를 반영한 로컬 푸드 축제나 스트리트 아트 이벤트 등을 기획하여 유동 인구를 늘리는 방안입니다.</p>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
                    <h3 class="text-xl font-bold text-gray-800 mb-2">스마트 교통 및 커뮤니티 조성</h3>
                    <p class="text-gray-600">AI로 대중교통 사각지대를 분석하고 자율주행 셔틀이나 공유 모빌리티를 도입합니다. 동시에 온오프라인 커뮤니티 플랫폼을 구축하여 유동 인구가 지역에 정착할 수 있는 기반을 마련합니다.</p>
                </div>
            </div>
        </section>

        <!-- Assessment -->
        <section>
            <h2 class="text-3xl font-bold text-gray-800 mb-6">4. 평가 (성취수준) 💯</h2>
            <div class="space-y-6">
                <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
                    <h3 class="text-xl font-bold text-gray-800 mb-2">상 (Excellent)</h3>
                    <p class="text-gray-600">창의적이고 혁신적인 아이디어를 구체적인 정책으로 발전시키며, 실현 가능성을 고려한 새로운 해결책을 제시함. AI 도구를 능숙하게 활용하고 자신의 아이디어를 효과적으로 발표함.</p>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
                    <h3 class="text-xl font-bold text-gray-800 mb-2">중 (Proficient)</h3>
                    <p class="text-gray-600">인구소멸 문제의 원인을 분석하며 참신한 아이디어를 제안함. AI 도구를 활용하여 자료를 수집, 분석하고 시각화하는 활동에 참여하며, 자신의 아이디어를 표현하는 능력을 갖춤.</p>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
                    <h3 class="text-xl font-bold text-gray-800 mb-2">하 (Developing)</h3>
                    <p class="text-gray-600">인구소멸 문제에 관심을 갖고 주어진 자료를 활용해 문제의 일부를 파악하려는 노력을 보임. AI 도구 사용에 대한 기본적인 안내를 통해 활동에 참여하고 간단한 결과물을 제작함.</p>
                </div>
            </div>
        </section>

        <!-- Population Simulation Prototype -->
        <section>
            <h2 class="text-3xl font-bold text-gray-800 mb-6">5. 인구 변화 시뮬레이션 📊</h2>
            <p class="text-gray-700 mb-4">
                학생들이 직접 경남지역의 도시를 선택하고 가상 정책 시나리오를 적용하여 미래 인구 변화를 예측해볼 수 있는 프로토타입입니다.
            </p>
            <div id="simulator-container" class="bg-white rounded-3xl shadow-xl w-full p-8 space-y-8">
                <!-- Simulation Controls -->
                <main class="space-y-6">
                    <div class="flex flex-col md:flex-row gap-6">
                        <div class="flex-1 bg-gray-50 p-6 rounded-2xl shadow-inner border border-gray-200">
                            <label for="city-select" class="block text-xl font-semibold text-gray-700 mb-2">
                                지역 선택
                            </label>
                            <select id="city-select" class="w-full p-3 rounded-xl border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200">
                                <!-- Options will be populated by JS -->
                            </select>
                        </div>
                        <div class="flex-1 bg-gray-50 p-6 rounded-2xl shadow-inner border border-gray-200">
                            <label for="scenario-select" class="block text-xl font-semibold text-gray-700 mb-2">
                                정책 시나리오 선택
                            </label>
                            <select id="scenario-select" class="w-full p-3 rounded-xl border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200">
                                <option value="base">기본 시나리오 (현재 추세 유지)</option>
                                <option value="youth">청년 유입 정책 (+청년 인구)</option>
                                <option value="birth">출산율 상승 정책 (+영유아 인구)</option>
                                <option value="elderly">고령인구 귀향 정책 (+노년 인구)</option>
                            </select>
                        </div>
                    </div>
                    <div class="text-center">
                        <button id="run-simulation-btn" class="bg-blue-600 text-white font-bold py-4 px-12 rounded-full shadow-lg hover:bg-blue-700 transition-all transform hover:scale-105">
                            시뮬레이션 실행
                        </button>
                    </div>
                </main>
                <!-- Simulation Results -->
                <section id="results" class="space-y-6 hidden">
                    <div class="bg-gray-50 p-6 rounded-2xl shadow-inner border border-gray-200">
                        <h2 class="text-2xl font-bold text-gray-700 mb-4 text-center">인구 피라미드</h2>
                        <div class="relative h-96">
                            <canvas id="population-chart"></canvas>
                        </div>
                        <div class="mt-6 flex justify-center flex-wrap">
                            <div class="chart-legend-item">
                                <span class="chart-legend-color bg-indigo-500 rounded-sm"></span>
                                <span class="text-gray-600">현재 (2024년)</span>
                            </div>
                            <div class="chart-legend-item">
                                <span class="chart-legend-color bg-teal-500 rounded-sm"></span>
                                <span class="text-gray-600">예측 (2044년)</span>
                            </div>
                        </div>
                    </div>
                    <div class="bg-green-50 p-6 rounded-2xl border border-green-200 shadow-md">
                        <h2 class="text-2xl font-bold text-green-700">결과 분석</h2>
                        <p id="analysis-text" class="mt-2 text-gray-800 leading-relaxed"></p>
                    </div>
                </section>
            </div>
        </section>

        <!-- Step-by-step Questions -->
        <section>
            <h2 class="text-3xl font-bold text-gray-800 mb-6">6. 단계별 질문 및 학습 활동 🙋‍♂️</h2>
            <div class="space-y-4">
                <!-- Mission 1 -->
                <div class="rounded-xl overflow-hidden shadow-md border border-gray-200">
                    <button class="collapsible bg-gray-50 p-6">
                        <span class="text-gray-800">미션 1: 우리 동네, 괜찮을까?</span>
                    </button>
                    <div class="content p-6 space-y-4">
                        <h4 class="font-bold text-gray-700">단계별 질문</h4>
                        <ul class="list-disc list-inside text-gray-600 space-y-2">
                            <li>소멸위험지역은 왜 생겨난 개념일까요?</li>
                            <li>우리 동네의 인구 피라미드를 보면 어떤 특징이 가장 눈에 띄나요?</li>
                            <li>인구 피라미드 모양이 현재 우리 동네의 어떤 사회 현상과 관련이 있다고 생각하나요?</li>
                        </ul>
                        <h4 class="font-bold text-gray-700 mt-4">최종 질문 (수준별)</h4>
                        <ul class="list-disc list-inside text-gray-600 space-y-2">
                            <li><strong>상:</strong> 우리 동네가 인구 소멸 위험을 겪는 구조적 원인은 무엇이며, 지속 가능한 발전을 위해 가장 시급히 해결해야 할 문제는 무엇인가요?</li>
                            <li><strong>중:</strong> 우리 동네가 겪고 있는 인구 문제의 핵심을 설명하고, 이를 해결하기 위한 아이디어를 제시해 보세요.</li>
                            <li><strong>하:</strong> 우리 동네가 소멸위험지역에 해당하는지 판단하고, 그 이유를 인구 피라미드 특징 한 가지를 들어 설명해 보세요.</li>
                        </ul>
                    </div>
                </div>
                <!-- Mission 2 -->
                <div class="rounded-xl overflow-hidden shadow-md border border-gray-200">
                    <button class="collapsible bg-gray-50 p-6">
                        <span class="text-gray-800">미션 2: 왜 우리 동네를 떠날까? & 텅 빈 마을, 어떤 일이?</span>
                    </button>
                    <div class="content p-6 space-y-4">
                        <h4 class="font-bold text-gray-700">단계별 질문</h4>
                        <ul class="list-disc list-inside text-gray-600 space-y-2">
                            <li>지방 인구 유출 원인으로 가장 많이 언급되는 것은 무엇인가요?</li>
                            <li>인구가 줄어들면 우리의 일상 중 가장 크게 달라질 세 가지는 무엇일까요?</li>
                            <li>텅 빈 마을을 다시 활기차게 만들기 위해 어떤 그림이나 이야기를 통해 아이디어를 표현하고 싶나요?</li>
                        </ul>
                        <h4 class="font-bold text-gray-700 mt-4">최종 질문 (수준별)</h4>
                        <ul class="list-disc list-inside text-gray-600 space-y-2">
                            <li><strong>상:</strong> 인구 감소의 원인과 영향을 심층 분석하고, '텅 빈 마을'의 상황을 가장 설득력 있게 보여줄 수 있는 그림이나 이야기를 창의적으로 표현해 보세요.</li>
                            <li><strong>중:</strong> 우리 동네 인구 유출의 주요 원인과 문제점을 연결하여, 그 심각성을 표현하는 짧은 이야기 또는 포스터를 만들어 보세요.</li>
                            <li><strong>하:</strong> 우리 동네를 떠나는 사람들의 마음은 어떨지 상상해보고, 인구가 줄어든 마을의 모습을 그림 한 장으로 간단하게 표현해 보세요.</li>
                        </ul>
                    </div>
                </div>
                <!-- Mission 3 -->
                <div class="rounded-xl overflow-hidden shadow-md border border-gray-200">
                    <button class="collapsible bg-gray-50 p-6">
                        <span class="text-gray-800">미션 3: 인구 변화 그래프 & 청년과 산업 관계 분석</span>
                    </button>
                    <div class="content p-6 space-y-4">
                        <h4 class="font-bold text-gray-700">단계별 질문</h4>
                        <ul class="list-disc list-inside text-gray-600 space-y-2">
                            <li>우리 동네와 인근 지역 인구 그래프에서 어떤 변화 추세가 보이나요?</li>
                            <li>인구가 증가하는 지역과 감소하는 지역의 특징은 무엇이며, 어떤 관계가 있다고 생각하나요?</li>
                            <li>청년 인구의 이동과 지역 산업의 관계를 조사하고, 우리 동네에 미치는 영향은 무엇일까요?</li>
                        </ul>
                        <h4 class="font-bold text-gray-700 mt-4">최종 질문 (수준별)</h4>
                        <ul class="list-disc list-inside text-gray-600 space-y-2">
                            <li><strong>상:</strong> 청년 인구 유입/유출을 결정하는 주요 원인과 지역 산업의 관계를 심층적으로 논하여, 우리 동네를 위한 청년 유치 정책 아이디어 3가지를 구체적으로 제안해 보세요.</li>
                            <li><strong>중:</strong> 우리 동네 인구 문제의 원인이 지역 산업과 어떤 관계가 있는지 설명하고, 이를 해결하기 위한 아이디어 한 가지를 제시해 보세요.</li>
                            <li><strong>하:</strong> 우리 동네와 인구가 늘어나는 이웃 동네의 가장 큰 차이점은 무엇이며, 그 차이가 우리 동네 청년 인구에 어떤 영향을 미칠지 이야기해 보세요.</li>
                        </ul>
                    </div>
                </div>
                <!-- Final Questions -->
                <div class="rounded-xl overflow-hidden shadow-md border border-gray-200">
                    <button class="collapsible bg-gray-50 p-6">
                        <span class="text-gray-800">정리 질문 및 활동</span>
                    </button>
                    <div class="content p-6 space-y-4">
                        <h4 class="font-bold text-gray-700">최종 정리 질문 (수준별)</h4>
                        <ul class="list-disc list-inside text-gray-600 space-y-2">
                            <li><strong>상:</strong> 우리 모둠의 캠페인이 실제 사회에 어떤 영향을 미칠지 예측하고, 다음 프로젝트에서 보완할 점을 구체적으로 설명해보세요.</li>
                            <li><strong>중:</strong> 이번 프로젝트를 통해 AI 도구가 인구소멸 문제 해결에 어떤 도움을 줄 수 있는지 설명하고, 자신의 역할과 기여도를 중심으로 소감을 발표해 보세요.</li>
                            <li><strong>하:</strong> 우리 동네 인구 문제에 대해 새롭게 알게 된 점은 무엇인가요? 이 문제를 해결하기 위해 일상생활에서 어떤 노력을 할 수 있을지 한 가지 이야기해 봅시다.</li>
                        </ul>
                        <h4 class="font-bold text-gray-700 mt-4">학생 활동</h4>
                        <ul class="list-disc list-inside text-gray-600 space-y-2">
                            <li><strong>개별 성찰 일기 작성:</strong> AI 도구 활용 소감, 배운 점, 어려웠던 점을 기록합니다.</li>
                            <li><strong>포트폴리오 정리:</strong> 프로젝트 결과물과 받은 피드백을 디지털 포트폴리오에 정리합니다.</li>
                            <li><strong>한 줄 요약 발표:</strong> 자신의 가장 큰 배움을 한 줄로 요약하여 발표합니다.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="text-center text-gray-400 mt-12 pt-8 border-t border-gray-200">
            <p class="text-lg font-bold text-gray-500">PEACE_SHINY ✨</p>
        </footer>
    </div>

    <script>
        // JavaScript for collapsible sections and simulation
        var coll = document.getElementsByClassName("collapsible");
        for (let i = 0; i < coll.length; i++) {
            coll[i].addEventListener("click", function() {
                this.classList.toggle("active");
                var content = this.nextElementSibling;
                if (content.style.maxHeight){
                    content.style.maxHeight = null;
                } else {
                    content.style.maxHeight = content.scrollHeight + "px";
                }
            });
        }
        
        // Simulation Script
        const cityData = {
            '창원시': [9986, 8526, 8027, 7125, 6429, 5754, 5275, 4940, 4541, 4000, 3500, 3000, 2500, 2000, 1500, 1000],
            '진주시': [3329, 5193, 2762, 2462, 2228, 1978, 1844, 1742, 1682, 1600, 1500, 1400, 1300, 1200, 1100, 1000],
            '거제시': [3082, 899, 2469, 2071, 1747, 1516, 1264, 1076, 935, 800, 700, 600, 500, 400, 300, 200],
            '합천군': [242, 109, 164, 155, 137, 123, 102, 87, 80, 70, 60, 50, 40, 30, 20, 10]
        };
        const ageLabels = [
            '0-4세', '5-9세', '10-14세', '15-19세', '20-24세', '25-29세', '30-34세', '35-39세',
            '40-44세', '45-49세', '50-54세', '55-59세', '60-64세', '65-69세', '70-74세', '75세 이상'
        ];
        const citySelect = document.getElementById('city-select');
        const scenarioSelect = document.getElementById('scenario-select');
        const runSimulationBtn = document.getElementById('run-simulation-btn');
        const resultsSection = document.getElementById('results');
        const analysisText = document.getElementById('analysis-text');
        const chartCanvas = document.getElementById('population-chart');
        let chartInstance = null;
        function initializeCitySelect() {
            for (const city in cityData) {
                const option = document.createElement('option');
                option.value = city;
                option.textContent = city;
                citySelect.appendChild(option);
            }
        }
        runSimulationBtn.addEventListener('click', () => {
            const selectedCity = citySelect.value;
            const selectedScenario = scenarioSelect.value;
            if (!selectedCity) {
                alert('지역을 선택해주세요.');
                return;
            }
            const initialData = cityData[selectedCity];
            const simulatedData = runSimulation(initialData, selectedScenario);
            drawPopulationChart(initialData, simulatedData, selectedCity);
            updateAnalysisText(initialData, simulatedData, selectedScenario);
            resultsSection.classList.remove('hidden');
            resultsSection.scrollIntoView({ behavior: 'smooth' });
        });
        function runSimulation(initialData, scenario) {
            let simulated = [...initialData];
            const years = 20;
            for (let i = 0; i < years; i++) {
                let nextYearData = new Array(simulated.length).fill(0);
                for (let j = 0; j < simulated.length; j++) {
                    if (j + 1 < simulated.length) {
                        nextYearData[j + 1] += simulated[j] * 0.98;
                    }
                }
                const birthRatePopulation = simulated[6] + simulated[7] + simulated[8];
                nextYearData[0] = birthRatePopulation * 0.05;
                simulated = nextYearData;
            }
            switch (scenario) {
                case 'youth':
                    simulated[4] = simulated[4] * 1.20;
                    simulated[5] = simulated[5] * 1.20;
                    break;
                case 'birth':
                    simulated[0] = simulated[0] * 1.30;
                    simulated[1] = simulated[1] * 1.15;
                    break;
                case 'elderly':
                    simulated[simulated.length - 1] = simulated[simulated.length - 1] * 1.15;
                    simulated[simulated.length - 2] = simulated[simulated.length - 2] * 1.10;
                    break;
                default:
                    break;
            }
            return simulated.map(p => Math.round(p));
        }
        function drawPopulationChart(initial, simulated, city) {
            const ctx = chartCanvas.getContext('2d');
            if (chartInstance) {
                chartInstance.destroy();
            }
            chartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ageLabels,
                    datasets: [
                        {
                            label: '현재 (2024년)',
                            data: initial,
                            backgroundColor: 'rgba(99, 102, 241, 0.7)',
                            borderColor: 'rgba(99, 102, 241, 1)',
                            borderWidth: 1,
                            borderRadius: 6,
                            barThickness: 15,
                        },
                        {
                            label: '예측 (2044년)',
                            data: simulated,
                            backgroundColor: 'rgba(20, 184, 166, 0.7)',
                            borderColor: 'rgba(20, 184, 166, 1)',
                            borderWidth: 1,
                            borderRadius: 6,
                            barThickness: 15,
                        }
                    ]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            stacked: true,
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: '인구 (명)',
                                color: '#4b5563',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                }
                            },
                            ticks: {
                                color: '#6b7280',
                            }
                        },
                        y: {
                            stacked: true,
                            grid: {
                                display: false
                            },
                            title: {
                                display: true,
                                text: '연령대',
                                color: '#4b5563',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                }
                            },
                            ticks: {
                                color: '#6b7280',
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false,
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.7)',
                            titleFont: {
                                size: 16,
                                weight: 'bold'
                            },
                            bodyFont: {
                                size: 14
                            },
                            padding: 10,
                            boxPadding: 4,
                        }
                    }
                }
            });
        }
        function updateAnalysisText(initial, simulated, scenario) {
            const initialTotal = initial.reduce((sum, val) => sum + val, 0);
            const simulatedTotal = simulated.reduce((sum, val) => sum + val, 0);
            const totalChange = simulatedTotal - initialTotal;
            const totalChangePercent = (totalChange / initialTotal * 100).toFixed(1);
            const initialYouth = initial[4] + initial[5];
            const simulatedYouth = simulated[4] + simulated[5];
            const youthChange = simulatedYouth - initialYouth;
            const youthChangePercent = (youthChange / initialYouth * 100).toFixed(1);
            let scenarioText = '';
            switch (scenario) {
                case 'youth':
                    scenarioText = '청년 유입 정책을 통해';
                    break;
                case 'birth':
                    scenarioText = '출산율 상승 정책을 통해';
                    break;
                case 'elderly':
                    scenarioText = '고령인구 귀향 정책을 통해';
                    break;
                default:
                    scenarioText = '현재 추세대로라면';
                    break;
            }
            analysisText.innerHTML = `
                <p><strong class="font-semibold text-green-800">[${scenarioText}]</strong> 20년 후 총 인구는 ${initialTotal}명에서 ${simulatedTotal}명으로 약 <span class="text-blue-600 font-bold">${totalChangePercent}%</span> ${totalChange > 0 ? '증가' : '감소'}할 것으로 예측됩니다.</p>
                <p class="mt-2">특히, 청년 인구(20-29세)는 ${initialYouth}명에서 ${simulatedYouth}명으로 <span class="text-blue-600 font-bold">${youthChangePercent}%</span> ${youthChange > 0 ? '증가' : '감소'}할 것으로 예상됩니다. 이 결과를 바탕으로 우리 지역이 나아가야 할 방향에 대해 토론해보세요.</p>
            `;
        }
        window.onload = () => {
            initializeCitySelect();
        };
    </script>
</body>
</html>
